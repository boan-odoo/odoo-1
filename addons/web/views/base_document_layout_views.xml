<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="view_base_document_layout" model="ir.ui.view">
            <field name="name">Document Layout</field>
            <field name="model">base.document.layout</field>
            <field name="arch" type="xml">
                <form class="o_document_layout">
                    <group>
                        <group class="o_document_layout_company">
                            <field name="company_id" invisible="1"/>
                            <field name="external_report_layout_id" invisible="1" />
                            <field name="logo_primary_color" invisible="1" />
                            <field name="logo_secondary_color" invisible="1" />
                            <field name="report_layout_id" widget="radio" string="Layout"/>
                            <field name="logo" widget="image"/>
                            <label for="primary_color" string="Colors" />
                            <div class="o_document_layout_colors">
                                <field name="primary_color" widget="color"/>
                                <field name="secondary_color" widget="color"/>
                                <field name="custom_colors" class="d-none" />
                                <button class="btn btn-link" title="Reset to logo colors" attrs="{'invisible': [('custom_colors', '=', False)]}">
                                    <label for="custom_colors" class="fa fa-refresh" string="" />
                                </button>
                            </div>
                            <field name="font" widget="font"/>
                            <field name="report_header" placeholder="e.g. Global Business Solutions" />
                            <field name="report_footer" string="Footer" placeholder="e.g. Opening hours, bank accounts (one per line)" />
                            <field name="paperformat_id" required="1" />
                        </group>
                        <div>
                            <field name="preview" widget="iframe_wrapper" />
                        </div>
                    </group>
                    <footer>
                        <button string="Save" class="btn-primary" type="object" name="document_layout_save"/>
                        <button special="cancel" string="Cancel" />
                    </footer>
                </form>
            </field>
        </record>

        <record id="action_base_document_layout_configurator" model="ir.actions.act_window">
            <field name="type">ir.actions.act_window</field>
            <field name="name">Configure your document layout</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
            <field name="res_model">base.document.layout</field>
            <field name="view_id" ref="web.view_base_document_layout"/>
        </record>

        <template id="web.master_input">
            <t t-set="set_master_pwd" t-value="set_master_pwd or False" />
            <t t-set="input_class" t-value="'form-control'" />

            <t t-if="insecure">
                <t t-if="set_master_pwd">
                    <input type="hidden" name="master_pwd" class="form-control" value="admin"/>
                </t>
                <t t-else="">
                    <div class="alert alert-warning">
                        <p>Warning, your Odoo database manager is not protected. To secure it, we have generated the following master password for it:</p>
                        <p style="text-align: center;"><strong class="generated_master_pwd"></strong></p>
                        <p>You can change it below but be sure to remember it, it will be asked for future operations on databases.</p>
                    </div>
                    <t t-set="input_class" t-value="'form-control generated_master_pwd_input'" />
                </t>
            </t>
            <t t-if="not insecure or not set_master_pwd">
                <div class="form-group row">
                    <label for="master_pwd" class="col-md-4 col-form-label">Master Password</label>
                    <div class="col-md-8 input-group">
                        <input name="master_pwd"
                            t-att-class="input_class"
                            required="required"
                            autofocus="autofocus"
                            type="password"
                            autocomplete="current-password" />
                        <div class="input-group-append">
                            <span class="fa fa-eye o_little_eye input-group-text" aria-hidden="true" style="cursor: pointer;"></span>
                        </div>
                    </div>
                </div>
            </t>
        </template>

        <template id="web.create_form">
            <t t-call="web.master_input" />
            <div class="form-group row">
                <label for="name" class="col-md-4 col-form-label">Database Name</label>
                <div class="col-md-8">
                    <input id="dbname" type="text" name="name" class="form-control" required="required" autocomplete="off" t-att-pattern="pattern" title="Only alphanumerical characters, underscore, hyphen and dot are allowed"/>
                </div>
            </div>
            <div class="form-group row">
                <label for="login" class="col-md-4 col-form-label">Email</label>
                <div class="col-md-8">
                    <input id="login" type="text" name="login" class="form-control" required="required" autocomplete="off"/>
                </div>
            </div>
            <div class="form-group row">
                <label for="password" class="col-md-4 col-form-label">Password</label>
                <div class="col-md-8 input-group">
                    <input id="password" type="password" name="password" class="form-control" required="required" autocomplete="off"/>
                    <div class="input-group-append">
                        <span class="fa fa-eye o_little_eye input-group-text" aria-hidden="true" style="cursor: pointer;"></span>
                    </div>
                </div>
            </div>
            <div class="form-group row">
                <label for="phone" class="col-md-4 col-form-label">Phone number</label>
                <div class="col-md-8 input-group">
                    <input id="phone" type="tel" name="phone" class="form-control" autocomplete="off"/>
                </div>
            </div>
            <div class="form-group row">
                <label for="lang" class="col-md-4 col-form-label">Language</label>
                <div class="col-md-8">
                    <select id="lang" name="lang" class="form-control" required="required" autocomplete="off">
                        <t t-foreach="langs" t-as="lang">
                            <t t-if="lang[0] == 'en_US'">
                                <option t-att-value="lang[0]" t-out="lang[1]" selected="selected"/>
                            </t>
                            <t t-else="">
                                <option t-att-value="lang[0]" t-out="lang[1]"/>
                            </t>
                        </t>
                    </select>
                </div>
            </div>
            <div class="form-group row">
                <label for="country" class="col-md-4 col-form-label ">Country</label>
                <div class="col-md-8">
                    <select id="country" name="country_code" class="form-control" autocomplete="off">
                        <option value=""></option>
                        <t t-foreach="countries" t-as="country">
                            <option t-att-value="country[0]" t-out="country[1]"/>
                        </t>
                    </select>
                </div>
            </div>
            <div class="form-group row">
                <label for="demo" class="col-md-4 col-form-label">Demo data</label>
                <div class="col-md-8">
                    <input type="checkbox" id="load_demo_checkbox" class="form-control-sm" name="demo" value="1" />
                </div>
            </div>
        </template>

        <template id="database_manager" name="My Invoices and Payments">
            <html>
                <head>
                    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
                    <title>Odoo</title>
                    <link rel="shortcut icon" href="/web/static/img/favicon.ico" type="image/x-icon" />

                    <t t-call-assets="web.assets_database_manager" />
            </head>

            <body>
                <div class="container">
                    <!-- Database List -->
                    <div class="row">
                        <div class="col-lg-6 offset-lg-3 o_database_list">
                            <img src="/web/static/img/logo2.png" class="img-fluid d-block mx-auto"/>
                            <t t-if="not list_db">
                                <div class="alert alert-danger text-center">The database manager has been disabled by the administrator</div>
                            </t>
                            <t t-elif="insecure and databases">
                                <div class="alert alert-warning">
                                    Warning, your Odoo database manager is not protected.<br/>
                                    Please <a href="#" data-toggle="modal" data-target=".o_database_master">set a master password</a> to secure it.
                                </div>
                            </t>
                            <t t-if="error">
                                <div class="alert alert-danger" t-out="error"></div>
                            </t>
                            <t t-if="list_db and databases">
                                <div class="list-group">

                                    <t t-foreach="databases" t-as="db">
                                        <div class="list-group-item d-flex align-items-center">
                                            <a t-attf-href="/web?db={{ db }}" class="d-block flex-grow-1">
                                                <t t-if="db in incompatible_databases">
                                                    <i class="icon fa fa-warning float-right text-warning" title="This database may not be compatible"></i>
                                                </t>
                                                <t t-out="db" />
                                            </a>
                                            <t t-if="manage">
                                                <div class="btn-group btn-group-sm float-right">
                                                    <button type="button" t-att-data-db="db" data-target=".o_database_backup" class="o_database_action btn btn-primary">
                                                        <i class="fa fa-floppy-o fa-fw"></i> Backup
                                                    </button>
                                                    <button type="button" t-att-data-db="db" data-target=".o_database_duplicate" class="o_database_action btn btn-secondary">
                                                        <i class="fa fa-files-o fa-fw"></i> Duplicate
                                                    </button>
                                                    <button type="button" t-att-data-db="db" data-target=".o_database_delete" class="o_database_action btn btn-danger">
                                                        <i class="fa fa-trash-o fa-fw"></i> Delete
                                                    </button>
                                                </div>
                                            </t>
                                        </div>
                                    </t>
                                </div>
                                <t t-if="manage">
                                    <div class="d-flex mt-2">
                                        <button type="button" data-toggle="modal" data-target=".o_database_create" class="btn btn-primary flex-grow-1">Create Database</button>
                                        <button type="button" data-toggle="modal" data-target=".o_database_restore" class="btn btn-primary flex-grow-1 ml-2">Restore Database</button>
                                        <button type="button" data-toggle="modal" data-target=".o_database_master" class="btn btn-primary flex-grow-1 ml-2">Set Master Password</button>
                                    </div>
                                </t>
                                <t t-else="">
                                    <div class="text-center mt-2">
                                        <a href="/web/database/manager">Manage databases</a>
                                    </div>
                                </t>
                            </t>
                            <t t-elif="list_db">
                                <form role="form" action="/web/database/create" method="post">
                                    <t t-call="web.create_form" />
                                    <input type="submit" value="Create database" class="btn btn-primary float-left"/>
                                </form>
                                <a role="button" data-toggle="modal" data-target=".o_database_restore" class="btn btn-link">or restore a database</a>
                            </t>
                        </div>
                    </div>

                    <!-- Create -->
                    <div class="modal fade o_database_create" role="dialog">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <form role="form" action="/web/database/create" method="post">
                                    <div class="modal-header">
                                        <h4 class="modal-title">Create Database</h4>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                                    </div>
                                    <div class="modal-body">
                                        <t t-call="web.create_form" />
                                        <small class="text-muted">
                                            To enhance your experience, some data may be sent to Odoo online services. See our <a href="https://www.odoo.com/privacy">Privacy Policy</a>.
                                        </small>
                                    </div>
                                    <div class="modal-footer">
                                        <input type="submit" value="Continue" class="btn btn-primary float-right"/>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Restore -->
                    <div class="modal fade o_database_restore" role="dialog">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h4 class="modal-title">Restore Database</h4>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                                </div>
                                <form id="form_restore_db" role="form" action="/web/database/restore" method="post" enctype="multipart/form-data">
                                    <div class="modal-body">
                                        <t t-call="web.master_input" />
                                        <div class="form-group row">
                                            <label for="backup_file" class="col-md-4 col-form-label">File</label>
                                            <div class="col-md-8">
                                                <input id="backup_file" type="file" name="backup_file" class="required"/>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="name" class="col-md-4 col-form-label">Database Name</label>
                                            <div class="col-md-8">
                                                <input id="dbname_restore" type="text" name="name" class="form-control" required="required" t-att-pattern="pattern" title="Only alphanumerical characters, underscore, hyphen and dot are allowed"/>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="copy">This database might have been moved or copied.</label>
                                            <p class="form-text">
                                                In order to avoid conflicts between databases, Odoo needs to know if this database was moved or copied.<br/>
                                                If you don't know, answer "This database is a copy".
                                            </p>
                                            <div class="custom-control custom-radio">
                                                <input id="radio_copy_true" name="copy" type="radio" class="custom-control-input" value="true" checked="1" />
                                                <label for="radio_copy_true" class="custom-control-label">This database is a copy</label>
                                            </div>
                                            <div class="custom-control custom-radio">
                                                <input id="radio_copy_false" name="copy" type="radio" class="custom-control-input" value="false" />
                                                <label for="radio_copy_false" class="custom-control-label">This database was moved</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <input type="submit" value="Continue" class="btn btn-primary float-right"/>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Master password -->
                    <div class="modal fade o_database_master" role="dialog">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h4 class="modal-title">Set Master Password</h4>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                                </div>
                                <form id="form_change_pwd" role="form" action="/web/database/change_password" method="post">
                                    <div class="modal-body">
                                        <p>The master password is required to create, delete, dump or restore databases.</p>
                                        <t t-set="set_master_pwd" t-value="True" />
                                        <t t-call="web.master_input" />
                                        <div class="form-group">
                                            <label for="master_pwd_new" class="col-form-label">New Master Password</label>
                                            <div class="input-group">
                                                <input id="master_pwd_new" type="password" name="master_pwd_new" class="form-control" required="required" autocomplete="new-password"/>
                                                <div class="input-group-append">
                                                    <span class="fa fa-eye o_little_eye input-group-text" aria-hidden="true" style="cursor: pointer;"></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <input type="submit" value="Continue" class="btn btn-primary float-right"/>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Duplicate DB -->
                    <div class="modal fade o_database_duplicate" role="dialog">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h4 class="modal-title">Duplicate Database</h4>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                                </div>
                                <form id="form-duplicate-db" role="form" action="/web/database/duplicate" method="post">
                                    <div class="modal-body">
                                        <t t-set="set_master_pwd" t-value="False" />
                                        <t t-call="web.master_input" />
                                        <div class="form-group">
                                            <label for="name" class="col-form-label">Database Name</label>
                                            <input id="dbname_duplicate" type="text" name="name" class="form-control" required="required" readonly="readonly"/>
                                        </div>
                                        <div class="form-group">
                                            <label for="new_name" class="col-form-label">New Name</label>
                                            <input id="new_name" type="text" name="new_name" class="form-control" required="required" t-att-pattern="pattern" title="Only alphanumerical characters, underscore, hyphen and dot are allowed"/>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <input type="submit" value="Continue" class="btn btn-primary float-right"/>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Drop DB -->
                    <div class="modal fade o_database_delete" role="dialog">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h4 class="modal-title">Delete Database</h4>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                                </div>
                                <form id="form_drop_db" role="form" action="/web/database/drop" method="post">
                                    <div class="modal-body">
                                        <t t-call="web.master_input" />
                                        <div class="form-group">
                                            <label for="name" class="col-form-label">Database</label>
                                            <input id="dbname_delete" type="text" name="name" class="form-control" required="required" readonly="readonly"/>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <input type="submit" value="Delete" class="btn btn-primary float-right"/>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Backup DB -->
                    <div class="modal fade o_database_backup" role="dialog">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h4 class="modal-title">Backup Database</h4>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                                </div>
                                <form id="form_backup_db" role="form" action="/web/database/backup" method="post">
                                    <div class="modal-body">
                                        <t t-call="web.master_input" />
                                        <div class="form-group">
                                            <label for="name" class="col-form-label">Database Name</label>
                                            <input id="dbname_backup" type="text" name="name" class="form-control" required="required" readonly="readonly"/>
                                        </div>
                                        <div class="form-group">
                                            <label for="backup_format" class="col-form-label">Backup Format</label>
                                            <select id="backup_format" name="backup_format" class="form-control" required="required">
                                                <option value="zip">zip (includes filestore)</option>
                                                <option value="dump">pg_dump custom format (without filestore)</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <input type="submit" value="Backup" class="btn btn-primary float-right"/>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </body>
            </html>
        </template>
    </data>
</odoo>
