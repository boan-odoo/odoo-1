/** @odoo-module **/

import { Define } from '@mail/define';

export default Define`
    {Record/insert}
        [Record/traits]
            Lifecycle
        [Lifecycle/name]
            onMounted
        [Lifecycle/model]
            AutocompleteInputComponent
        [Lifecycle/behavior]
            {if}
                @record
                .{AutocompleteInputComponent/isFocusOnMount}
            .{then}
                {UI/focus}
                    @record
                    .{AutocompleteInputComponent/root}
            :autoCompleteElem
                {Record/insert}
                    [Record/traits]
                        jQuery
                    @record
                    .{AutocompleteInputComponent/root}
                .{jQuery/autocomplete}
                    {Record/insert}
                        [Record/traits]
                            Dict
                        [autoFocus]
                            true
                        [select]
                            {Record/insert}
                                [Record/traits]
                                    Function
                                [Function/in]
                                    ev
                                    ui
                                [Function/out]
                                    {AutocompleteInputComponent/_onAutocompleteSelect}
                                        @record
                                        @ev
                                        @ui
                        [source]
                            {Record/insert}
                                [Record/traits]
                                    Function
                                [Function/in]
                                    req
                                    res
                                [Function/out]
                                    {AutocompleteInputComponent/_onAutocompleteSource}
                                        @req
                                        @res
                        [focus]
                            {Record/insert}
                                [Record/traits]
                                    Function
                                [Function/in]
                                    ev
                                [Function/out]
                                    {AutocompleteInputComponent/_onAutocompleteFocus}
                                        @record
                                        @ev
                        [html]
                            @record
                            .{AutocompleteInputComponent/isHtml}
                            .{|}
                                false
                        {if}
                            @record
                            .{AutocompleteInputComponent/customClass}
                        {then}
                            [classes]
                                [ui-autocomplete]
                                    @record
                                    .{AutocompleteInputComponent/customClass}
            {Dev/comment}
                Resize the autocomplete dropdown options to handle the long strings
                By setting the width of dropdown based on the width of the input element.
            {Record/update}
                [0]
                    @autoCompleteElem
                    .{jQuery/data}
                        ui-autocomplete
                [1]
                    [_resizeMenu]
                        {Record/insert}
                            [Record/traits]
                                Function
                            [Function/in]
                                self
                            [Function/out]
                                :ul
                                    @self
                                    .{jQuery.Element/menu}
                                    .{jQuery.Menu/element}
                                @ul
                                .{jQuery.Element/outerWidth}
                                    @self
                                    .{jQuery.Element/element}
                                    .{jQuery.Element/outerWidth}
`;
