<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

<t t-name="mail.RtcCallViewer" owl="1">
    <div
        class="o_RtcCallViewer"
        t-att-class="{ 'o-fullScreen': rtcCallViewer and rtcCallViewer.isFullScreen, 'o-isMinimized': rtcCallViewer and rtcCallViewer.isMinimized}"
        t-attf-class="{{ className }}"
        t-on-mouseleave="rtcCallViewer.onMouseLeave"
        t-ref="root"
    >
        <t t-if="rtcCallViewer">

            <!-- Used to make the component depend on the window size and trigger an update when the window size changes. -->
            <t t-set="dummy" t-value="messaging and messaging.device and messaging.device.globalWindowInnerHeight and messaging.device.globalWindowInnerWidth"/>

            <!-- Call members display -->
            <div class="o_RtcCallViewer_participantContainer" t-on-click="rtcCallViewer.onClick" t-on-mousemove="rtcCallViewer.onMouseMove">
                <t t-if="rtcCallViewer.mainParticipantCard">
                    <div class="o_RtcCallViewer_mainParticipantContainer justify-content-center mw-100 mh-100">
                        <RtcCallParticipantCard className="'o_RtcCallViewer_participantCard w-100'" localId="rtcCallViewer.mainParticipantCard.localId"/>
                        <t t-if="rtcCallViewer.showOverlay">
                            <t t-if="!rtcCallViewer.hasSidebar">
                                <i class="o_RtcCallViewer_sidebarButton fa fa-arrow-left" title="Show sidebar" t-on-click="rtcCallViewer.onClickShowSidebar"/>
                            </t>
                            <t t-elif="rtcCallViewer.hasSidebar">
                                <i class="o_RtcCallViewer_sidebarButton fa fa-arrow-right" title="hide sidebar" t-on-click="rtcCallViewer.onClickHideSidebar"/>
                            </t>
                        </t>
                    </div>
                </t>
                <t t-if="rtcCallViewer.tileParticipantCards.length > 0">
                    <div
                        class="o_RtcCallViewer_grid"
                        t-att-class="{ 'o-isSidebar': rtcCallViewer.hasSidebar and rtcCallViewer.mainParticipantCard, 'o-isTiled': !rtcCallViewer.mainParticipantCard }"
                        t-ref="tileContainer"
                        t-attf-style="--height:{{state.tileHeight}}px; --width:{{state.tileWidth}}px; --columns:{{state.columnCount}};"
                    >
                        <t t-foreach="rtcCallViewer.tileParticipantCards" t-as="participantCard" t-key="'grid_tile_'+participantCard.localId">
                            <!-- maybe filter focused partner out? -->
                            <RtcCallParticipantCard
                                className="'o_RtcCallViewer_participantCard o_RtcCallViewer_gridTile mw-100'"
                                localId="participantCard.localId"
                            />
                        </t>
                    </div>
                </t>
            </div>

            <!-- Buttons -->
            <t t-if="rtcCallViewer.showOverlay or !rtcCallViewer.isControllerFloating">
                <div class="o_RtcCallViewer_controls" t-att-class="{ 'o-isFloating': rtcCallViewer.isControllerFloating }">
                    <div class="o_RtcCallViewer_controlsOverlayContainer" t-on-mousemove="rtcCallViewer.onMouseMoveOverlay">
                        <RtcController localId="rtcCallViewer.rtcController.localId"/>
                    </div>
                </div>
            </t>

            <!-- Dialogs -->
            <t t-if="messaging.userSetting.rtcConfigurationMenu.isOpen">
                <Dialog size="'small'" title="rtcCallViewer.settingsTitle" onClosed="rtcCallViewer.onRtcSettingsDialogClosed">
                    <RtcConfigurationMenu/>
                    <t t-set-slot="buttons">
                        <!-- Explicit No buttons -->
                    </t>
                </Dialog>
            </t>
        </t>
    </div>
</t>

</templates>