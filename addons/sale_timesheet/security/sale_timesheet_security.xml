<?xml version="1.0" encoding="UTF-8"?>
<odoo noupdate="1">


        <!-- Override this rule because in hr_timesheet,
            the lowest access right can only see own timesheets (model: account.analytic.line)
            and this ir.rule accept all account.analytic.line in its domain.
            Therefore, we need to override this rule to change the domain, and then the
            rules for the account.analytic.line defined in timesheet will be apply.
         -->
        <record id="account.account_analytic_line_rule_billing_user" model="ir.rule">
            <field name="domain_force">[('project_id', '=', False)]</field>
        </record>

        <record model="ir.rule" id="project_profitability_report">
            <field name="name">Project costs and revenues: project visibility</field>
            <field name="model_id" ref="model_project_profitability_report"/>
            <field name="domain_force">['|',
                ('project_id.privacy_visibility', '!=', 'followers'),
                ('project_id.message_partner_ids', 'in', [user.partner_id.id])]
            </field>
        </record>

</odoo>
