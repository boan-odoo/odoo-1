<?xml version="1.0" encoding="UTF-8"?>

<templates xml:space="preserve">
    <t t-extend="im_livechat.legacy.mail.widget.Thread.Message">
        <t t-jquery='div.o_thread_message_content' t-operation="append">
            <t t-if="message.getChatbotStepAnswers()">
                <ul class="o_livechat_chatbot_options" t-att-data-chatbot-step-id="message.getChatbotStepId()">
                    <li t-foreach="message.getChatbotStepAnswers()" t-as="stepAnswer"
                        t-att-data-chatbot-step-answer-id="stepAnswer.id"
                        t-attf-class="d-inline-block border rounded p-2 mr-3 mb-1 font-weight-bold #{message.getChatbotAnswerClass(stepAnswer)}">
                        <t t-out="stepAnswer.label"/>
                    </li>
                </ul>
            </t>
        </t>
    </t>

    <t t-extend="im_livechat.legacy.mail.AbstractThreadWindow">
        <t t-jquery='div.o_chat_mini_composer' t-operation="after">
            <div class="d-none o_livechat_chatbot_end bg-200 font-italic text-center border">
                <span>Conversation ended...</span>
                <a href="#" class="o_livechat_chatbot_restart">Restart</a>
            </div>
        </t>
    </t>

    <!--
        This small template simulates a fake message from the bot.
        The goal is to have something like:
        [image] The bot
                . . .

        With a small animation on the dots to make them bounce.
        This fake message is then removed when the chat window is refreshed with the real message.
    -->
    <t t-name="im_livechat.legacy.chatbot.is_typing_message">
        <div t-attf-class="o_thread_message #{isWelcomeMessage ? 'o_mail_not_discussion' : ''}">
            <div class="o_thread_message_sidebar">
                <img alt="chatbot_image" t-att-src="chatbotImageSrc"
                    class="o_thread_message_avatar rounded-circle"/>
            </div>
            <div class="o_thread_message_core">
                <p class="o_mail_info text-muted">
                    <strong class="o_thread_author" t-out="chatbotName"/>
                </p>
                <div class="o_thread_message_content">
                    <div class="o_livechat_chatbot_typing">
                        <div class="o_livechat_chatbot_typing_dot"/>
                        <div class="o_livechat_chatbot_typing_dot"/>
                        <div class="o_livechat_chatbot_typing_dot"/>
                    </div>
                </div>
            </div>
        </div>
    </t>
</templates>
